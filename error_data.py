import os
import sys
os.system('cls' if os.name == 'nt' else 'clear') # Clear the screen

import glob
import pickle
import numpy as np

#os.chdir("/home/ahmadr/Desktop/GIT/fm_development/data/edited/error_analysis")
#
#fname = 'janus_rng_avg_600_med_flt_21_2008-11-04-12-00-41_2008-11-04-12-56-08.jns'
#
#dat = [0]*len( fname )
#dat = pickle.load( open( fname, 'rb' ) )
#
#os.chdir("/home/ahmadr/Desktop/GIT/fm_development")


# time_rng_avg
# time_but_bnd
# time_smt_mag
# time_raw_mag
# time_rot_mag
# time_fit_smt
# TODO:  pop 4 from all, except running average


# janus_rng_avg_600_med_flt_21_2008-11-04-12-00-41_2008-11-04-12-56-08.jns

time_rng_avg       = [ '12-00',
                       '12-02',
                       '12-03',
                       '12-05',
                       '12-10',
                       '12-12',
                       '12-13',
                       '12-15',
                       '12-16',
                       '12-18',
                       '12-20',
                       '12-21',
                       '12-23',
                       '12-25',
                       '12-26',
                       '12-28',
                       '12-30',
                       '12-31',
                       '12-33',
                       '12-34',
                       '12-36',
                       '12-38',
                       '12-39',
                       '12-41',
                       '12-43',
                       '12-44',
                       '12-46',
                       '12-47',
                       '12-49',
                       '12-51',
                       '12-52',
                       '12-54',
                       '12-56' ]

dat_fv_rng_avg     = [ 0.23623229743810098,
                       0.6006948375625829,
                       0.3812654313490801,
                       0.5668300806572936,
                       0.6441008741588307,
                       0.7302909339396236,
                       0.5919497688647545,
                       -0.21723562255119314,
                       0.8499495251101132,
                       0.6295743793967322,
                       0.5161480752473911,
                       0.32104508632981704,
                       0.3952576600079565,
                       -0.11693467550176306,
                       0.17367276109247812,
                       0.09349399093722278,
                       0.6620635148360836,
                       0.8778610494474223,
                       0.9877357112061361,
                       0.34560540946522766,
                       0.08166984382283182,
                       0.1700432085117373,
                       0.1339401273090349,
                       0.4898216825178605,
                       0.2836253081489643,
                       0.3425578932701675,
                       0.479659820833835,
                       0.8611464485781132,
                       -0.07053970933622525,
                       0.14645158440833417,
                       -0.06077733515695816,
                       0.2221716511013954,
                       0.2585611927247101 ]

dat_sig_fv_rng_avg = [ 0.27568138149589055,
                       0.2642839173667173,
                       0.178614077096555,
                       0.1806014186617996,
                       0.2048071877765062,
                       0.15904621926866572,
                       0.13386548105600152,
                       0.39749523338002823,
                       0.13269414538606794,
                       0.156366777979446,
                       0.2115699029523395,
                       0.2616749951980736,
                       0.22905658189505523,
                       0.25071602812561766,
                       0.1632921339155116,
                       0.1398475395911948,
                       0.13842886007345556,
                       0.23374573331967777,
                       0.3035012834921354,
                       0.2891434264568167,
                       0.19353517762721556,
                       0.25260901937761,
                       0.20911445357858202,
                       0.31462567311688294,
                       0.1594424498394056,
                       0.14273895238413373,
                       0.19090427960402997,
                       0.44056301535375947,
                       0.2935239845149509,
                       0.3788751404154713,
                       0.43587139992327,
                       0.20382041306998427,
                       0.22347914869060195 ]

dat_sig_bb_rng_avg = [ 0.027488445852038558,
                       0.029407044385498675,
                       0.038106841250954787,
                       0.024772242332361444,
                       0.038659531243218193,
                       0.045906783862451811,
                       0.053938316719622952,
                       0.033491637254769877,
                       0.059525723143392044,
                       0.03557051391605251,
                       0.041868845275786826,
                       0.036941669385182237,
                       0.035177315673556059,
                       0.042260264449628562,
                       0.047786050536913982,
                       0.067993071553463069,
                       0.1042615854541647,
                       0.052159969756453269,
                       0.047284785619208548,
                       0.054699841205765112,
                       0.03878399694861779,
                       0.054497291248441201,
                       0.040904258608935685,
                       0.055374406208460465,
                       0.034382379994242367,
                       0.038039344211862017,
                       0.046653583911807184,
                       0.065549712954491121,
                       0.035845116409359223,
                       0.045524734291420121,
                       0.026752097333468977,
                       0.034974542179044027,
                       0.036581593483510262 ]

#dat_sig_bb_rng_avg = [ 0.090750662337016313,
#                       0.097104797496358683,
#                       0.12620010085986538,
#                       0.082007813871926252,
#                       0.12748560581303037,
#                       0.15193322779633697,
#                       0.17885239664258384,
#                       0.11067085935355754,
#                       0.19713058613275547,
#                       0.11759481259041968,
#                       0.13830901743958832,
#                       0.12140388635963995,
#                       0.11529555157105657,
#                       0.13817728884662095,
#                       0.15670768919706635,
#                       0.22339052223108835,
#                       0.34416014907533216,
#                       0.17402785105411783,
#                       0.15554595864283502,
#                       0.17928570231700502,
#                       0.12766878979529181,
#                       0.17902435954166962,
#                       0.13414627897929984,
#                       0.18179109102553193,
#                       0.11292523552153816,
#                       0.12482143932871989,
#                       0.15216719256267894,
#                       0.21513909457565311,
#                       0.117496639387777,
#                       0.14903345335861354,
#                       0.088230833704375886,
#                       0.11458058944716097,
#                       0.11948979255118156 ]

# janus_but_bnd_med_flt_21_2008-11-04-12-00-41_2008-11-04-12-56-08.jns

time_but_bnd       = [ '12-00',
                       '12-02',
                       '12-03',
                       '12-05',
                       '12-08',
                       '12-10',
                       '12-12',
                       '12-13',
                       '12-15',
                       '12-16',
                       '12-18',
                       '12-20',
                       '12-21',
                       '12-23',
                       '12-25',
                       '12-26',
                       '12-28',
                       '12-30',
                       '12-31',
                       '12-33',
                       '12-34',
                       '12-36',
                       '12-38',
                       '12-39',
                       '12-41',
                       '12-43',
                       '12-44',
                       '12-46',
                       '12-47',
                       '12-49',
                       '12-51',
                       '12-52',
                       '12-54',
                       '12-56' ]

dat_fv_but_bnd     = [ 0.18574662737235476,
                       0.4944318420047643,
                       0.3647199646836942,
                       0.646366112941183,
                       -0.11811086891196043,
                       0.48435214444720226,
                       0.7341109952653956,
                       0.7181989299042513,
                       -0.15040629375529152,
                       1.0743246078052628,
                       0.7027024065291086,
                       0.4653433794285114,
                       0.2531453521896266,
                       0.33278269572100144,
                       -0.11125378503707505,
                       0.18821765780547983,
                       0.09811819033534608,
                       0.6411554715917477,
                       0.8356387518101508,
                       0.8945160784062427,
                       0.4033676862067226,
                       0.10345496770403985,
                       -0.075490140883665,
                       0.18675695189027672,
                       0.049664150745402195,
                       0.19755676844789752,
                       0.4081103703749046,
                       0.22966720029754664,
                       1.26563964058386,
                       0.2884921463523233,
                       -0.1033811963765787,
                       0.10980993851250474,
                       0.2032517513321419,
                       0.40144240326078884 ]

dat_sig_fv_but_bnd = [ 0.20375526004988984,
                       0.231013198632247,
                       0.17811990414462991,
                       0.20544531874116026,
                       0.2967912988908549,
                       0.14908431298722802,
                       0.16834174498282523,
                       0.1540840751931088,
                       0.2913209759944079,
                       0.16063948597037966,
                       0.16182801139317582,
                       0.1921551853186909,
                       0.23386533870609894,
                       0.21637490055499747,
                       0.22636949612537682,
                       0.17493554460501842,
                       0.13491488752335948,
                       0.1758742508260003,
                       0.23199805106989513,
                       0.23329220099426964,
                       0.5521408532380996,
                       0.19245180097411324,
                       0.2254991383765952,
                       0.2529522370501394,
                       0.13624934470446343,
                       0.16639845350183108,
                       0.17275733490334694,
                       0.2577660823584979,
                       0.5076083453637104,
                       0.2974894145032422,
                       0.3409238431153286,
                       0.3702869478482112,
                       0.23955114577393657,
                       0.3328293900701006 ]

# janus_smt_mag_med_flt_21_2008-11-04-12-00-41_2008-11-04-12-56-08.jns

time_smt_mag       = [ '12-00',
                       '12-02',
                       '12-03',
                       '12-05',
                       '12-08',
                       '12-10',
                       '12-12',
                       '12-13',
                       '12-15',
                       '12-16',
                       '12-18',
                       '12-20',
                       '12-21',
                       '12-23',
                       '12-25',
                       '12-26',
                       '12-28',
                       '12-30',
                       '12-31',
                       '12-33',
                       '12-34',
                       '12-36',
                       '12-38',
                       '12-39',
                       '12-41',
                       '12-43',
                       '12-44',
                       '12-46',
                       '12-47',
                       '12-49',
                       '12-51',
                       '12-52',
                       '12-54',
                       '12-56' ]

dat_fv_smt_mag     = [ -0.09077401958208405,
                       0.11332419049982204,
                       0.4043002957150091,
                       0.5872087375403935,
                       -0.2410544647650744,
                       0.42523946464144086,
                       0.7286305528218425,
                       0.5184756704293876,
                       -0.19916380377402157,
                       1.0373966311123097,
                       0.9178486252379704,
                       0.7316130473204708,
                       -0.002355592609196302,
                       0.3545097234701794,
                       -0.017227128112646834,
                       0.09989755980746229,
                       -0.05296303964063588,
                       0.591914591377824,
                       0.8039522957544325,
                       0.6758160001263177,
                       0.5937749017166627,
                       -0.11136363047449972,
                       0.4896883507529423,
                       0.6219467926861791,
                       -0.02667459666000032,
                       -0.42306994578651935,
                       -0.11555224818469838,
                       -0.6289404240276053,
                       0.4554904871311698,
                       -0.14957174514131932,
                       -0.3259493032315867,
                       0.14923406468023268,
                       0.3217271932294844,
                       0.9035021832264951 ]

dat_sig_fv_smt_mag = [ 0.3701088655074477,
                       0.34191046341666403,
                       0.2516155763461187,
                       0.2523110273773551,
                       0.3187007030641727,
                       0.2498968067071869,
                       0.22468679719595275,
                       0.15208592238097757,
                       0.5432629918137553,
                       0.14827165996160385,
                       0.22018000263128862,
                       0.31967740354594215,
                       0.36021325523153586,
                       0.31469073126839164,
                       0.24787118638268338,
                       0.17226316305995099,
                       0.18160840563344988,
                       0.13914917018878875,
                       0.20203099829945767,
                       0.2667007117890688,
                       0.2223680584816538,
                       0.2419183594869355,
                       0.21220492232052035,
                       0.2205129776935349,
                       0.2145398503718691,
                       0.22737127687582143,
                       0.24125195864714558,
                       0.15792759517578872,
                       0.3561198230781456,
                       0.33256012559727344,
                       0.3352590088964655,
                       0.42157455599209176,
                       0.35839349159628214,
                       0.30715379671660115 ]

# janus_raw_mag_2008-11-04-12-00-41_2008-11-04-12-56-08.jns

time_raw_mag       = [ '12-00',
                       '12-02',
                       '12-03',
                       '12-05',
                       '12-08',
                       '12-10',
                       '12-12',
                       '12-13',
                       '12-15',
                       '12-16',
                       '12-18',
                       '12-20',
                       '12-21',
                       '12-23',
                       '12-25',
                       '12-26',
                       '12-28',
                       '12-30',
                       '12-31',
                       '12-33',
                       '12-34',
                       '12-36',
                       '12-38',
                       '12-39',
                       '12-41',
                       '12-43',
                       '12-44',
                       '12-46',
                       '12-47',
                       '12-49',
                       '12-51',
                       '12-52',
                       '12-54',
                       '12-56']

dat_fv_raw_mag     = [ 0.0009379666332885102,
                       0.003205578271135944,
                       0.39691619777667386,
                       0.29144006037382086,
                       -0.3294192514444066,
                       0.15643631464718533,
                       0.4465449365074891,
                       0.46771680258127857,
                       -0.25409524881828327,
                       0.9344757659168124,
                       0.5722942489183093,
                       0.49271873595326326,
                       -0.29394389038200947,
                       0.26700547985482126,
                       0.06512784077952485,
                       0.07532389248898341,
                       0.022776442151765768,
                       0.482172624858632,
                       0.729039334423409,
                       0.6004614873112548,
                       0.5206805700917077,
                       -0.017151346866232722,
                       0.3208600228522134,
                       0.5528831547576103,
                       -0.02561295839822218,
                       -0.27806712364631664,
                       -0.1618437246301777,
                       -0.5731909074469662,
                       0.4552060916384702,
                       0.05452898194065479,
                       -0.2195883304195473,
                       0.11519467672149065,
                       0.32704670534674657,
                       0.8375504679340614 ]

dat_sig_fv_raw_mag = [ 0.2815093341693475,
                       0.25621150323117053,
                       0.20620295663190022,
                       0.23525511210082964,
                       0,
                       0.18973799896293625,
                       0.19433539394277735,
                       0.12889748361567877,
                       0.43026949055826735,
                       0.14764135789657742,
                       0.19105176662388565,
                       0.25885208442755664,
                       0.3324149678831909,
                       0.2759330632381436,
                       0.21730750702299334,
                       0.14932877920764634,
                       0.1718163514913309,
                       0.13089264551275542,
                       0.18700969098475967,
                       0.22941682296261032,
                       0.20287477497337777,
                       0.1790344296349015,
                       0.18653832216078026,
                       0.1755357859826878,
                       0.19965678337411216,
                       0.1941178665730204,
                       0.2056207224207921,
                       0.14934301286194818,
                       0.30283601314936437,
                       0.3080499778469423,
                       0.29177498763750753,
                       0.3284994099469125,
                       0.3173763054962464,
                       0.26912793320807143 ]

# janus_rot_mag_med_flt_21_2008-11-04-12-00-41_2008-11-04-12-56-08.jns

time_rot_mag       = [ '12-00',
                       '12-02',
                       '12-03',
                       '12-05',
                       '12-08',
                       '12-10',
                       '12-12',
                       '12-13',
                       '12-15',
                       '12-16',
                       '12-18',
                       '12-20',
                       '12-21',
                       '12-23',
                       '12-25',
                       '12-26',
                       '12-28',
                       '12-30',
                       '12-31',
                       '12-33',
                       '12-34',
                       '12-36',
                       '12-38',
                       '12-39',
                       '12-41',
                       '12-43',
                       '12-44',
                       '12-46',
                       '12-47',
                       '12-49',
                       '12-51',
                       '12-52',
                       '12-54',
                       '12-56']
 
dat_fv_rot_mag     = [ 0.08626466009833227,
                       0.04596737037871505,
                       0.4730284742153795,
                       0.33596351769403743,
                       0.18060325814270806,
                       0.641718491819504,
                       0.7797283987199732,
                       0.318070716862544,
                       -0.387010829694862,
                       0.9959142084393162,
                       1.0964081905625496,
                       0.5929204431872118,
                       0.21125882056791834,
                       0.4974868489694197,
                       -0.4367451954749291,
                       0.32807622876362674,
                       -0.2785032697801857,
                       0.31366653116057636,
                       0.621323995505256,
                       0.12047318372725498,
                       1.0691027874778338,
                       1.018260669648072,
                       -0.3429044202384183,
                       0.2125879870243798,
                       -1.4318924631906222,
                       -0.2013308710664254,
                       0.13025049051868742,
                       0.6142060000896655,
                       0.26024937356934535,
                       -0.5885562831762516,
                       0.7585688200937143,
                       0.22788436757022687,
                       0.27899982857620403,
                       1.020874202497542 ]

dat_sig_fv_rot_mag = [ 0.36366865076278126,
                       0.37135403150441704,
                       0.2822744069598188,
                       0.2726897873944618,
                       0.4674828095764947,
                       0.24170126324669858,
                       0.23512483347533583,
                       0.15539917730747532,
                       0.4807455992950105,
                       0.1580113243490015,
                       0.24273267365055104,
                       0.33698542984712604,
                       0.4769896245383596,
                       0.3983744368225145,
                       0.34778583053993256,
                       0.2777953811628692,
                       0.2573691743930951,
                       0.29009310629629503,
                       0.27088047343893323,
                       0.517059801066024,
                       0.4306038767746627,
                       0.33345228117566506,
                       0.4455777808026674,
                       0.39807636792607287,
                       0.28939116830990214,
                       0.22859475565034268,
                       0.2689567133549307,
                       0.2901672286858074,
                       0.5640231058425331,
                       0.4554349225684601,
                       0.514635143398579,
                       0.600922981264191,
                       0.5805737371652546,
                       0.3554192406694346 ]

# janus_fit_smt_med_flt_21_2008-11-04-12-00-41_2008-11-04-12-56-08.jns

time_fit_smt       = [ '12-00',
                       '12-02',
                       '12-03',
                       '12-05',
                       '12-08',
                       '12-10',
                       '12-12',
                       '12-13',
                       '12-15',
                       '12-16',
                       '12-18',
                       '12-20',
                       '12-21',
                       '12-23',
                       '12-25',
                       '12-26',
                       '12-28',
                       '12-30',
                       '12-31',
                       '12-33',
                       '12-34',
                       '12-36',
                       '12-38',
                       '12-39',
                       '12-41',
                       '12-43',
                       '12-44',
                       '12-46',
                       '12-47',
                       '12-49',
                       '12-51',
                       '12-52',
                       '12-54',
                       '12-56' ]

dat_fv_fit_smt     = [ -0.11059206567441479,
                       -0.14468427210497517,
                       -0.5841333887244315,
                       -0.07504649090887291,
                       0.25184445117915694,
                       0.7670201695351295,
                       1.1657672373782402,
                       -0.7660530189391791,
                       -0.9851458029322847,
                       1.3558433613537453,
                       0.8067853703380152,
                       -0.05187434376204073,
                       2.714670376976947,
                       -0.8919573857696994,
                       0.8607780697520573,
                       1.1358623155201693,
                       0.39607207220485713,
                       1.1258702493606914,
                       1.6508699703453158,
                       3.8509513269205544,
                       2.795226072080769,
                       2.9641719038584253,
                       -1.6534500752505141,
                       0.6610441153154402,
                       -1.8719210431882325,
                       0.556208392373287,
                       1.2834051876721109,
                       1.4359569076632341,
                       -1.024073105952439,
                       -0.4711882226905368,
                       -1.4559824081454036,
                       -0.043636246162257586,
                       0.8860274669177013,
                       0.7833072169103127 ]


dat_sig_fv_fit_smt = [ 0.4178897515632123,
                       0.4630873630680891,
                       0.5736225031557963,
                       0.4957784843744775,
                       0.5834717776859087,
                       0.42158156840377176,
                       0.48065512238803937,
                       0.49134044390661563,
                       1.0260411006787373,
                       0.38936310428818627,
                       0.47810387163387935,
                       0.5330036542995533,
                       0.7112477805042134,
                       0.7897467543518643,
                       0.568632820547394,
                       0.5708575709818471,
                       0.6063511854781142,
                       0.5780939396676122,
                       0.8871422722020104,
                       1.1418750336211296,
                       1.137141250404879,
                       0.7160555698129613,
                       0.862510999999187,
                       0.6243823839904691,
                       0.21107076335853722,
                       0.4232277925331036,
                       0.49432871088674973,
                       0.2498970869438237,
                       0.9607492176155447,
                       0.7227419105996167,
                       0.8689417051333506,
                       0.9863211314705315,
                       1.1863463279129354,
                       0.6590270712529102 ]

# time_rng_avg
# time_but_bnd
# time_smt_mag
# time_raw_mag
# time_rot_mag
# time_fit_smt

pop_ind = [ 7, 13, 17, 27, 28, 29, 30, 31, 32 ]

a = 4

time_but_bnd.pop( a )
dat_fv_but_bnd.pop( a )
dat_sig_fv_but_bnd.pop( a )

time_smt_mag.pop( a )
dat_fv_smt_mag.pop( a )
dat_sig_fv_smt_mag.pop( a )

time_raw_mag.pop( a )
dat_fv_raw_mag.pop( a )
dat_sig_fv_raw_mag.pop( a )

time_rot_mag.pop( a )
dat_fv_rot_mag.pop( a )
dat_sig_fv_rot_mag.pop( a )

time_fit_smt.pop( a )
dat_fv_fit_smt.pop( a )
dat_sig_fv_fit_smt.pop( a )

k = 0

for i in pop_ind :

	time_rng_avg.pop( i-k )
	dat_fv_rng_avg.pop( i-k )
	dat_sig_fv_rng_avg.pop( i-k )
	dat_sig_bb_rng_avg.pop( i -k )

	time_but_bnd.pop( i-k )
	dat_fv_but_bnd.pop( i-k )
	dat_sig_fv_but_bnd.pop( i-k )

	time_smt_mag.pop( i-k )
	dat_fv_smt_mag.pop( i-k )
	dat_sig_fv_smt_mag.pop( i-k )

	time_raw_mag.pop( i-k )
	dat_fv_raw_mag.pop( i-k )
	dat_sig_fv_raw_mag.pop( i-k )

	time_rot_mag.pop( i-k )
	dat_fv_rot_mag.pop( i-k )
	dat_sig_fv_rot_mag.pop( i-k )

	time_fit_smt.pop( i-k )
	dat_fv_fit_smt.pop( i-k )
	dat_sig_fv_fit_smt.pop( i-k )

	k += 1

#print mean( dat_fv_rng_avg )
#print mean( dat_fv_but_bnd )
#print mean( dat_fv_smt_mag )
#print mean( dat_fv_raw_mag )
#print mean( dat_fv_rot_mag )
#print mean( dat_fv_fit_smt )

#print mean( dat_sig_fv_rng_avg )
#print mean( dat_sig_fv_but_bnd )
#print mean( dat_sig_fv_smt_mag )
#print mean( dat_sig_fv_raw_mag )
#print mean( dat_sig_fv_rot_mag )
#print mean( dat_sig_fv_fit_smt )

#plt.figure( )

fig, ax1 = plt.subplots()

ax1.plot( range( 24 ), dat_sig_fv_rng_avg, marker='^', linewidth=0.5, 
color='r', label=r'$\sigma_V$ (running average)' )
#ax1.plot( range( 24 ), dat_sig_fv_but_bnd, marker='*', linewidth=0.5,
#color='g', label=r'$\sigma_V$ ( butterworth)' )
#ax1.plot( range( 24 ), dat_sig_fv_smt_mag, marker='<', linewidth=0.5,
#color='b', label=r'$\sigma_V$ (smoothed)' )
ax1.plot( range( 24 ), dat_sig_fv_raw_mag, marker='>', linewidth=0.5,
color='c', label=r'$\sigma_V$ ( raw)' )
#ax1.plot( range( 24 ), dat_sig_fv_rot_mag, marker='.', linewidth=0.5,
#color='m', label='rotated MF' )
#ax1.plot( range( 24 ), dat_sig_fv_fit_smt, marker='o', linewidth=0.5,
#color='k', label='fit MF' )

ax1.set_xlim( -0.5, 24 )
ax1.set_ylim( 0, 0.5 )

ax1.set_xlabel( 'Observation number', fontsize=22 )
ax1.set_ylabel( r'$\sigma_{V}$', fontsize=22, color='r' )
ax1.set_title( 'Comparison of error for various MFI', fontsize=24 )
ax1.legend( loc=2, fontsize=16 )

#ax1.xticks([0, 5, 10, 15, 20, 25], fontsize=24 )

x1_ticks = [ 0, 5, 10, 15, 20, 25 ]
y1_ticks = [ 0, 0.1, 0.2, 0.3, 0.4, 0.5 ]

ax1.set_xticks( x1_ticks )
ax1.set_yticks( y1_ticks )
ax1.set_xticklabels( x1_ticks, fontsize=20 )
ax1.set_yticklabels( y1_ticks, fontsize=20 )

ax2 = ax1.twinx( )

ax2.plot( range( 24 ), dat_sig_bb_rng_avg, marker='*', linewidth=1.0, color='b',
 label=r'$\Delta B$' )
#ax2.scatter( range( 24 ), dat_fv_but_bnd, marker='<', color='m', label='butterworth' )

ax2.legend( loc=1, fontsize=16 )

y2_ticks = [ 0.02, 0.04, 0.06, 0.08, 0.1 ]

ax2.set_yticks( y2_ticks )
ax2.set_yticklabels( y2_ticks, fontsize=20 )

ax2.set_ylabel( r'$\Delta B$', fontsize=22, color='b' )
fig.tight_layout( )

plt.show( )
